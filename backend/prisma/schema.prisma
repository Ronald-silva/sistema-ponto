generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id             String        @id @default(uuid())
  name           String
  password       String
  cpf            String        @unique
  role           UserRole
  salary         Float
  birth_date     DateTime
  admission_date DateTime
  active         Boolean       @default(true)
  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
  timeRecords    TimeRecord[]
  userProjects   UserProject[]
}

model Project {
  id                String        @id @default(uuid())
  name              String
  description       String?
  companyId         String
  category          String        @default("CONSTRUCTION")
  location          String?
  start_date        DateTime      @default(now())
  estimated_end_date DateTime?
  createdAt         DateTime      @default(now())
  updatedAt         DateTime      @updatedAt
  active            Boolean       @default(true)
  status            String        @default("Em Andamento")
  timeRecords       TimeRecord[]
  users             UserProject[]
}

model TimeRecord {
  id        String   @id @default(uuid())
  userId    String
  projectId String
  timestamp DateTime
  type      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  project   Project  @relation(fields: [projectId], references: [id])
  user      User     @relation(fields: [userId], references: [id])
}

model UserProject {
  userId     String
  projectId  String
  assignedAt DateTime @default(now())
  project    Project  @relation(fields: [projectId], references: [id])
  user       User     @relation(fields: [userId], references: [id])

  @@id([userId, projectId])
}

enum UserRole {
  ADMIN
  ALMOXARIFE_A
  ANALISTA_ADMINISTRATIVO_II
  ANALISTA_AMBIENTAL_JUNIOR
  ANALISTA_COMPRAS_JUNIOR_A
  ANALISTA_CONTROLADORIA_JUNIOR_A
  ANALISTA_ORCAMENTO_JUNIOR_A
  ANALISTA_PLANEJAMENTO_JUNIOR_A
  ASSISTENTE_ADM_V
  ASSISTENTE_COMPRAS
  ASSISTENTE_CONTROLADORIA_C
  ASSISTENTE_DP_C
  ASSISTENTE_OBRA_A
  ASSISTENTE_TI_A
  ASSISTENTE_FINANCEIRO
  ASSISTENTE_TECNICO_III
  AUX_ADMINISTRATIVO_I
  AUX_BOMBEIRO_HIDRAULICO
  AUXILIAR_ADMINISTRATIVO_B
  AUXILIAR_ALMOXARIFADO
  AUXILIAR_BOMBEIRO
  AUXILIAR_MUNK
  AUXILIAR_OBRA_A
  BOMBEIRO_HIDRAULICO
  COORDENADOR_ADM_FINANCEIRO
  ENCARREGADO_OBRAS
  ENCARREGADO_OBRAS_I
  ENGENHEIRO_CIVIL
  ESTAGIARIO
  ESTAGIARIO_ENDOMARKETING
  ESTAGIARIO_PROCESSOS
  GERENTE_OBRAS
  JOVEM_APRENDIZ
  LIDER_EQUIPE
  MESTRE_OBRAS
  MOTORISTA
  MOTORISTA_I
  MOTORISTA_GUINCHO
  OPERADOR_MAQUINA_TERRAPLANAGEM
  PEDREIRO
  RECEPCIONISTA
  SERVENTE
  SERVICOS_GERAIS_I
  SERVICOS_GERAIS_II
  SUPERVISOR_ADM_II
  SUPERVISOR_COMPRAS
  SUPERVISOR_DP_A
  SUPERVISOR_DH
  SUPERVISOR_OBRA
  SUPERVISOR_SEGURANCA_TRABALHO
  SUPERVISOR_FINANCEIRO
  TECNICO_SEGURANCA_TRABALHO_II
  TOPOGRAFO
  VIGIA
}
